\section{МОДЕЛЬ ХИМИЧЕСКОЙ КИНЕТИКИ}

\subsection{Теория}

Для описания химической реакции необходимо знать закономерности её протекания во времени, т. е. её скорость и механизм. Скорость и
механизм химических превращений изучает раздел химии ~--- химическая кинетика.

Будем рассматривать многокомпонентную систему переменного состава из $N$ веществ, в которой протекает $N_R$ реакций вида:

%\begin{equation*}
$$
\sum\limits_{i = 1}^{N}\overrightarrow{\nu_i^{(r)}}M_i \xleftrightarrow[\overrightarrow{W^{(r)}}]{\overleftarrow{W^{(r)}}} \sum\limits_{i = 1}^{N}\overleftarrow{\nu_i^{(r)}}M_i,\\
\overleftrightarrow{q^{(r)}} = \sum\limits_{i = 1}^{N}\overleftrightarrow{\nu_i^{(r)}},\\
r = 1, ..., N_R.\\
$$
%\end{equation*}

Здесь $r$ ~--- порядковый номер реакции.

В записи каждой реакции фигурирует $W_i$ ~--- скорость химической реакции. Она прямо пропорциональна произведению объёмных концентраций
участвующих в ней компонентов и так называемой константы скорости реакции $\overleftrightarrow{K^{r}}(T)$, зависящей от температуры
(в общем случае и от давления):

\begin{equation}
    \overleftrightarrow{W^{r}} = \overleftrightarrow{K^{r}}(T)\prod\limits_i(\rho\gamma_i)^{\overleftrightarrow{\nu^{r}}}
\end{equation}

\subsection{Примеры}

В задачах химической кинетики на вход программе поступают не дифференциальные уравнения, а список химических уравнений, начальные
температура и давление и описание примесей при их наличии.

В данном примере показано моделирование пяти реакций с начальными концентрациями $\mu_{H_2} = 0.5$ и $\mu_{O_2} = 0.5$, нормальным
атмосферным давлением и температурой $T = 2300K$.

% \begin{figure}
%     \begin{subfigure}[t]{0.5\linewidth}
%         \centering
%         $$
%         \begin{cases}
%             H2 + O2 => 2OH\\
%             H + O2 => OH + O\\
%             H2 + OH => H2O + H\\
%             H2 + O => OH + H\\
%             2OH => H2O + O\\
%             T = 2300K\\
%             P = 101325Pa
%         \end{cases}
%         $$
%         \caption{}
%     \end{subfigure}
%     \hfill
%     \begin{subfigure}[t]{0.5\linewidth}
%         \centering
%         \input{inc/Graphics/ODU-Chemical-1}
%         \caption{}
%     \end{subfigure}
%     \hfill
%     \caption{Логотипы МАИ: а) Логотип МАИ; б) Еще один логотип МАИ; в) Снова логотип МАИ}
%     \label{fig:fig02}
%   \end{figure}

$$
\begin{cases}
    H_2 + O_2 \Longleftrightarrow 2OH\\
    H + O_2 \Longleftrightarrow OH + O\\
    H_2 + OH \Longleftrightarrow H_2O + H\\
    H_2 + O \Longleftrightarrow OH + H\\
    2OH \Longleftrightarrow H_2O + O\\
    T = 2300\text{К}\\
    P = 101325\text{Па}
\end{cases}
$$

\begin{figure}
    \input{inc/Graphics/ODU-Chemical-1}
    \caption{Решение задачи хим. кинетики}
    \label{fig:chem1}
\end{figure}

% \begin{table}    
%     %\caption{Таблица сравнения методов}
%     \begin{tabularx}{\textwidth}{X c}
%         $$
%         \begin{cases}
%             H2 + O2 => 2OH\\
%             H + O2 => OH + O\\
%             H2 + OH => H2O + H\\
%             H2 + O => OH + H\\
%             2OH => H2O + O\\
%             T = 2300K\\
%             P = 101325Pa
%         \end{cases}
%         $$
%     &
%         \begin{figure}
%             \input{inc/Graphics/ODU-Chemical-1}
%             \caption{Решение задачи хим. кинетики}
%             \label{fig:chem1}
%         \end{figure}\\
%     \end{tabularx}
%     \label{tab:Methods}
% \end{table}

%\begin{}

По графику видно, что реакция протекает примерно за 1 микросекунду после чего система приходит в равновесие.

По оси X указано время, по оси Y ~--- мольно-массовые концентрации веществ. Так как концентрации $H_2$ и $O_2$ заданы по $0.5$, то их
мольно-массовые концентрации оказались равны примерно $29.3991$ моль/кг.

Для решения данной задачи использовался неявный метод Гаусса 6го порядка с итерациями Зейделя, однако для неё можно использовать и
другие неявные методы. В таблице \ref{tab:Methods1} приведены сравнения некоторых неявных и явных методов для решения данной задачи по
времени и количеству шагов.

\begin{table}    
    \caption{Таблица сравнения методов}
    \begin{tabularx}{\textwidth}{|X|c|c|c|}
    \hline
    Метод & Время работы (мс) & Количество шагов & Точность\\
    \hline
    Неявный Гаусс 6-го порядка & 254 & 35 & 0.001\\
    \hline
    Неявный Гаусс 4-го порядка & 11 & 35 & 0.001\\
    \hline
    Неявный Гаусс 2-го порядка & 235 & 50 & 0.001\\
    \hline
    Явный Рунге-Кутта 6-го порядка & 92 & 100 & 0.001\\
    \hline
    Явный Рунге-Кутта 4-го порядка & 55 & 100 & 0.001\\
    \hline
    Вложенный Дормана-Принц 4-го порядка & 191 & 200 & 0.001\\
    \hline
    Вложенный Фалберг 2-го порядка & 97 & 200 & 0.001\\
    \hline
    \end{tabularx}
    \label{tab:Methods1}
\end{table}

В следующем примере показано моделирование семи реакций с начальными концентрациями $\mu_{H_2} = 0.5$ и $\mu_{O_2} = 0.5$, нормальным
атмосферным давлением и температурой $T = 2300K$. Данный пример отличается от предыдущего наличием добавки $M$ в последних двух реакциях.

$$
\begin{cases}
    H_2 + O_2 \Longleftrightarrow 2OH\\
    H + O_2 \Longleftrightarrow OH + O\\
    H_2 + OH \Longleftrightarrow H_2O + H\\
    H_2 + O \Longleftrightarrow OH + H\\
    2OH \Longleftrightarrow H_2O + O\\
    H + OH + M \Longleftrightarrow H_2O + M\\
    2H + M \Longleftrightarrow H_2 + M\\
    T = 2300\text{К}\\
    P = 101325\text{Па}
\end{cases}
$$

\begin{figure}
    \input{inc/Graphics/ODU-Chemical-2}
    \caption{Решение задачи хим. кинетики}
    \label{fig:chem2}
\end{figure}

Стоит отметить, что добавка $M$ это ни что иное как сумма концентраций всех веществ, участвующих в реакциях. Благодаря этой добавке
можно сократить число реакций с 17 до 7. Количество дифференциальных уравнений в данном случае не меняется, однако приходится
отдельно обрабатывать случай наличия лобавки в реакции и время работы алгоритма заметно падает.

В таблице \ref{tab:Methods2} приведено сравнение различных методов по времени и количеству шагов.

\begin{table}    
    \caption{Таблица сравнения методов}
    \begin{tabularx}{\textwidth}{|X|c|c|c|}
    \hline
    Метод & Время работы (мс) & Количество шагов & Точность\\
    \hline
    Неявный Гаусс 6-го порядка & 331 & 50 & 0.001\\
    \hline
    Неявный Гаусс 4-го порядка & 145 & 35 & 0.001\\
    \hline
    Неявный Гаусс 2-го порядка & 201 & 100 & 0.001\\
    \hline
    Явный Рунге-Кутта 6-го порядка & 64 & 100 & 0.001\\
    \hline
    Явный Рунге-Кутта 4-го порядка & 41 & 100 & 0.001\\
    \hline
    Вложенный Дормана-Принц 4-го порядка & 245 & 200 & 0.001\\
    \hline
    Вложенный Фалберг 2-го порядка & 102 & 200 & 0.001\\
    \hline
    \end{tabularx}
    \label{tab:Methods2}
\end{table}

\subsection{Моделирование взрыва}

Оба этих примера расчитывались при постоянной температуре и меняющейся плотности. В задачах моделирования взрыва температура меняется
вместе с концентрациями. В примере \ref{fig:bomb} показано моделирование взрыва "бомбы" с начальными концентрациями
$\mu_{H_2} = 0.5$ и $\mu_{O_2} = 0.5$, нормальным атмосферным давлением и температурой $T = 2300K$. 

%график
\begin{figure}
    \begin{subfigure}[t]{0.45\linewidth}
        \centering
        \input{inc/Graphics/ODU-Chemical-3}
        \caption{}
    \end{subfigure}
    \hfill
    \begin{subfigure}[t]{0.45\linewidth}
        \centering
        \input{inc/Graphics/ODU-Chemical-Temp}
        \caption{}
    \end{subfigure}
    \hfill
    \caption{Моделирование взрыва: а) Мольно-массовые концентрации; б) Температура}
    \label{fig:bomb}
\end{figure}

Конечное значение температуры стало равно примерно $3285K$. Сами концентрации меняются быстрее, чем в предыдущем примере и система
приходит в равновесие примерно за 2 микросекунды.