#include <iostream>
#include <cmath>
#include "../General.hpp"
#include "../Matrix.hpp"

void butcherWrite (const std::vector<std::pair<Matrix<float128_t>, std::string>> &tables) {
    for (uint64_t i = 0; i < tables.size(); ++i) {
        std::ofstream file(tables[i].second);
        file << tables[i].first;
        file.close();
    }
}

int main () {
    std::vector<std::pair<Matrix<float128_t>, std::string>> tables = {

        {Matrix<float128_t>(4, 4, {
            0, 0, 0, 0,
            1.0/3.0, 1.0/3.0, 0, 0,
            2.0/3.0, 0, 2.0/3.0, 0,
            0, 1.0/4.0, 0, 3.0/4.0
        }), "BT-RungeKutta-3-1.bin"},

        {Matrix<float128_t>(4, 4, {
            0, 0, 0, 0,
            2.0/3.0, 2.0/3.0, 0, 0,
            2.0/3.0, -1.0/3.0, 1, 0,
            0, 1.0/4.0, 1.0/2.0, 1.0/4.0
        }), "BT-RungeKutta-3-2.bin"},

        {Matrix<float128_t>(4, 4, {
            0, 0, 0, 0,
            1.0/2.0, 1.0/2.0, 0, 0,
            1, -1, 2, 0,
            0, 1.0/6.0, 2.0/3.0, 1.0/6.0
        }), "BT-RungeKutta-3-3.bin"},

        {Matrix<float128_t>(4, 4, {
            0, 0, 0, 0,
            1.0/2.0, 1.0/2.0, 0, 0,
            3.0/4.0, 0, 3.0/4.0, 0,
            0, 2.0/9.0, 1.0/3.0, 4.0/9.0
        }), "BT-RungeKutta-3-4.bin"},

        {Matrix<float128_t>(5, 5, {
            0, 0, 0, 0, 0,
            1.0/2.0, 1.0/2.0, 0, 0, 0,
            1.0/2.0, 0, 1.0/2.0, 0, 0,
            1, 0, 0, 1, 0,
            0, 1.0/6.0, 1.0/3.0, 1.0/3.0, 1.0/6.0
        }), "BT-RungeKutta-4-1.bin"},

        {Matrix<float128_t>(5, 5, {
            0, 0, 0, 0, 0,
            1.0/3.0, 1.0/3.0, 0, 0, 0,
            2.0/3.0, -1.0/3.0, 1.0, 0, 0,
            1, 1, -1, 1, 0,
            0, 1.0/8.0, 3.0/8.0, 3.0/8.0, 1.0/8.0
        }), "BT-RungeKutta-4-2.bin"},

        {Matrix<float128_t>(5, 5, {
            0, 0, 0, 0, 0,
            1.0/4.0, 1.0/4.0, 0, 0, 0,
            1.0/2.0, 0, 1.0/2.0, 0, 0,
            1, 1, -2, 2, 0,
            0, 1.0/6.0, 0, 2.0/3.0, 1.0/6.0
        }), "BT-RungeKutta-4-3.bin"},

        {Matrix<float128_t>(5, 5, {
            0, 0, 0, 0, 0,
            1.0/2.0, 1.0/2.0, 0, 0, 0,
            1.0/2.0, (std::sqrt(2.0)-1.0)/2.0, 1.0-1.0/std::sqrt(2.0), 0, 0,
            1, 0, -1.0/std::sqrt(2.0), 1.0+1.0/std::sqrt(2.0), 0,
            0, 1.0/6.0, 1.0/3.0-1.0/(3*std::sqrt(2.0)), 1.0/3.0+1.0/(3*std::sqrt(2.0)), 1.0/6.0
        }), "BT-RungeKutta-4-4.bin"},

        {Matrix<float128_t>(7, 7, {
            0, 0, 0, 0, 0, 0, 0,
            1.0/4.0, 1.0/4.0, 0, 0, 0, 0, 0,
            1.0/2.0, 1.0/2.0, 0, 0, 0, 0, 0,
            1.0/2.0, 1.0/7.0, 2.0/7.0, 1.0/14.0, 0, 0, 0,
            3.0/4.0, 3.0/8.0, 0, -1.0/2.0, 7.0/8.0, 0, 0,
            1, -4.0/7.0, 12.0/7.0, -2.0/7.0, -1, 7, 0,
            0, 7.0/90.0, 16.0/45.0, -1.0/3.0, 7.0/15.0, 16.0/45.0, 7.0/90.0

        }), "BT-RungeKutta-6-1.bin"},

        {Matrix<float128_t>(8, 8, {
            0, 0, 0, 0, 0, 0, 0, 0,
            1.0/2.0, 1.0/2.0, 0, 0, 0, 0, 0, 0,
            2.0/3.0, 2.0/9.0, 4.0/9.0, 0, 0, 0, 0, 0,
            1.0/3.0, 7.0/36.0, 2.0/9.0, -1.0/12.0, 0, 0, 0, 0,
            5.0/6.0, -35.0/144.0, -55.0/36.0, 35.0/48.0, 15.0/8.0, 0, 0, 0,
            1.0/6.0, -1.0/360.0, -11.0/36.0, -1.0/8.0, 1.0/2.0, 1.0/10.0, 0, 0,
            1, -41.0/260.0, 22.0/13.0, 43.0/156.0, -118.0/39.0, 32.0/195.0, 80.0/39.0, 0,
            0, 13.0/200.0, 0, 11.0/40.0, 11.0/40.0, 4.0/25.0, 4.0/25.0, 13.0/200.0

        }), "BT-RungeKutta-6-2.bin"},

        {Matrix<float128_t>(5, 4, {
            0, 0, 0, 0,
            1, 1, 0, 0,
            1.0/2.0, 1.0/4.0, 1.0/4.0, 0,
            0, 1.0/2.0, 1.0/2.0, 0,
            0, 1.0/6.0, 1.0/6.0, 4.0/6.0
        }), "BT-Falberg-2-1.bin"},

        {Matrix<float128_t>(6, 5, {
            0, 0, 0, 0, 0,
            1.0/4.0, 1.0/4.0, 0, 0, 0,
            27.0/40.0, -189.0/800.0, 729.0/800.0, 0, 0,
            1, 214.0/891.0, 1.0/33.0, 650.0/891.0, 0,
            0, 214.0/891.0, 1.0/33.0, 650.0/891.0, 0,
            0, 533.0/2106.0, 0, 800.0/1053.0, -1.0/78.0
        }), "BT-Falberg-2-2.bin"},

        {Matrix<float128_t>(6, 5, {
            0, 0, 0, 0, 0,
            1.0/4.0, 1.0/4.0, 0, 0, 0,
            1.0/2.0, 0, 1.0/2.0, 0, 0,
            1, 1, -2, 2, 0,
            0, 1, -2, 0, 2,
            0, 1.0/6.0, 0, 4.0/6.0, 1.0/6.0
        }), "BT-Cheskino-2-1.bin"},

        {Matrix<float128_t>(7, 6, {
            0, 0, 0, 0, 0, 0,
            1.0/3.0, 1.0/3.0, 0, 0, 0, 0,
            1.0/3.0, 1.0/6.0, 1.0/6.0, 0, 0, 0,
            1.0/2.0, 1.0/8.0, 0, 3.0/8.0, 0, 0,
            1, 1.0/2.0, 0, -3.0/2.0, 2, 0,
            0, 1.0/10.0, 0, 3.0/10.0, 2.0/5.0, 1.0/5.0,
            0, 1.0/6.0, 0, 0, 2.0/3.0, 1.0/6.0
        }), "BT-Merson-3-1.bin"},

        {Matrix<float128_t>(2, 2, {
            1, 1,
            0, 1
        }), "BT-Rado-1-1.bin"},

        {Matrix<float128_t>(3, 3, {
            1.0/3.0, 5.0/12.0, -1.0/12.0,
            1, 3.0/4.0, 1.0/4.0,
            0, 3.0/4.0, 1.0/4.0
        }), "BT-Rado-3-1.bin"},

        {Matrix<float128_t>(4, 4, {
            (4.0-std::sqrt(6.0))/10, (88.0-7*std::sqrt(6.0))/360, (296.0-169*std::sqrt(6.0))/1800, (-2.0+3*std::sqrt(6.0))/255,
            (4.0+std::sqrt(6.0))/10, (296.0+169*std::sqrt(6.0))/1800, (88.0+7*std::sqrt(6.0))/360, (-2.0-3*std::sqrt(6.0))/255,
            1, (16.0-std::sqrt(6.0))/36, (16.0+std::sqrt(6.0))/36, 1.0/9.0,
            0, (16.0-std::sqrt(6.0))/36, (16.0+std::sqrt(6.0))/36, 1.0/9.0
        }), "BT-Rado-5-1.bin"},

        {Matrix<float128_t>(2, 2, {
            1.0/2.0, 1.0/2.0,
            0, 1
        }), "BT-Gauss-2-1.bin"},

        {Matrix<float128_t>(3, 3, {
            1.0/2.0-std::sqrt(3.0)/6.0, 1.0/4.0, 1.0/4.0-std::sqrt(3.0)/6.0,
            1.0/2.0+std::sqrt(3.0)/6.0, 1.0/4.0+std::sqrt(3.0)/6.0, 1.0/4.0,
            0, 1.0/2.0, 1.0/2.0
        }), "BT-Gauss-4-1.bin"},

        {Matrix<float128_t>(4, 4, {
            1.0/2.0-std::sqrt(15.0)/10.0, 5.0/36.0, 2.0/9.0-std::sqrt(15.0)/15.0, 5.0/36.0-std::sqrt(15.0)/30.0,
            1.0/2.0, 5.0/36.0+std::sqrt(15.0)/24.0, 2.0/9.0, 5.0/36.0-std::sqrt(15.0)/24.0,
            1.0/2.0+std::sqrt(15.0)/10.0, 5.0/36.0+std::sqrt(15.0)/30.0, 2.0/9.0+std::sqrt(15.0)/15.0, 5.0/36.0,
            0, 5.0/18.0, 4.0/9.0, 5.0/18.0
        }), "BT-Gauss-6-1.bin"},

        {Matrix<float128_t>(3, 3, {
            0, 0, 0,
            1, 1.0/2.0, 1.0/2.0,
            0, 1.0/2.0, 1.0/2.0
        }), "BT-Lobatto-2-1.bin"},

        {Matrix<float128_t>(3, 3, {
            0, 1.0/2.0, 0,
            1, 1.0/2.0, 0,
            0, 1.0/2.0, 1.0/2.0
        }), "BT-Lobatto-2-2.bin"},

        {Matrix<float128_t>(3, 3, {
            0, 1.0/2.0, -1.0/2.0,
            1, 1.0/2.0, 1.0/2.0,
            0, 1.0/2.0, 1.0/2.0
        }), "BT-Lobatto-2-3.bin"},

        {Matrix<float128_t>(3, 3, {
            0, 0, 0,
            2.0/3.0, 1.0/3.0, 1.0/3.0,
            0, 1.0/4.0, 3.0/4.0
        }), "BT-Lobatto-2-4.bin"},

        {Matrix<float128_t>(4, 4, {
            0, 0, 0, 0,
            1.0/2.0, 1.0/4.0, 1.0/4.0, 0,
            1, 0, 1, 0,
            0, 1.0/6.0, 2.0/3.0, 1.0/6.0
        }), "BT-Lobatto-4-1.bin"},

        {Matrix<float128_t>(4, 4, {
            0, 0, 0, 0,
            1.0/2.0, 5.0/24.0, 1.0/3.0, -1.0/24.0,
            1, 1.0/6.0, 2.0/3.0, 1.0/6.0,
            0, 1.0/6.0, 2.0/3.0, 1.0/6.0
        }), "BT-Lobatto-4-2.bin"},

        {Matrix<float128_t>(4, 4, {
            0, 1.0/6.0, -1.0/6.0, 0,
            1.0/2.0, 1.0/6.0, 1.0/3.0, 0,
            1, 1.0/6.0, 5.0/6.0, 0,
            0, 1.0/6.0, 2.0/3.0, 1.0/6.0
        }), "BT-Lobatto-4-3.bin"},

        {Matrix<float128_t>(4, 4, {
            0, 1.0/6.0, -1.0/3.0, 1.0/6.0,
            1.0/2.0, 1.0/6.0, 5.0/12.0, -1.0/12.0,
            1, 1.0/6.0, 2.0/3.0, 1.0/6.0,
            0, 1.0/6.0, 2.0/3.0, 1.0/6.0
        }), "BT-Lobatto-4-4.bin"},

        {Matrix<float128_t>(5, 5, {
            0, 0, 0, 0, 0,
            (5.0-std::sqrt(5.0))/10.0, (5.0+std::sqrt(5.0))/60.0, 1.0/6.0, (15.0-7.0*std::sqrt(5.0))/60.0, 0,
            (5.0+std::sqrt(5.0))/10.0, (5.0-std::sqrt(5.0))/60.0, (15.0+7.0*std::sqrt(5.0))/60.0, 1.0/6.0, 0,
            1, 1.0/6.0, (5.0-std::sqrt(5.0))/12.0, (5.0+std::sqrt(5.0))/12.0, 0,
            0, 1.0/12.0, 5.0/12.0, 5.0/12.0, 1.0/12.0

        }), "BT-Lobatto-6-1.bin"},

        {Matrix<float128_t>(5, 5, {
            0, 0, 0, 0, 0,
            (5.0-std::sqrt(5.0))/10.0, (11.0+std::sqrt(5.0))/120.0, (25.0-std::sqrt(5.0))/120.0, (25.0-13.0*std::sqrt(5.0))/120.0, (-1+std::sqrt(5.0))/120.0,
            (5.0+std::sqrt(5.0))/10.0, (11.0-std::sqrt(5.0))/120.0, (25.0+13.0*std::sqrt(5.0))/120.0, (25.0+std::sqrt(5.0))/120.0, (-1-std::sqrt(5.0))/120.0,
            1, 1.0/12.0, 5.0/12.0, 5.0/12.0, 1.0/12.0,
            0, 1.0/12.0, 5.0/12.0, 5.0/12.0, 1.0/12.0
        }), "BT-Lobatto-6-2.bin"},

        {Matrix<float128_t>(5, 5, {
            0, 1.0/12.0, (-1-std::sqrt(5.0))/24.0, (-1+std::sqrt(5.0))/24.0, 0,
            (5.0-std::sqrt(5.0))/10.0, 1.0/12.0, (25.0+std::sqrt(5.0))/120.0, (25.0-13.0*std::sqrt(5.0))/120.0, 0,
            (5.0+std::sqrt(5.0))/10.0, 1.0/12.0, (25.0+13.0*std::sqrt(5.0))/120.0, (25.0-std::sqrt(5.0))/120.0, 0,
            1, 1.0/12.0, (11.0-std::sqrt(5.0))/120.0, (11.0+std::sqrt(5.0))/120.0, 0,
            0, 1.0/12.0, 5.0/12.0, 5.0/12.0, 1.0/12.0
        }), "BT-Lobatto-6-3.bin"},

        {Matrix<float128_t>(5, 5, {
            0, 1.0/12.0, -std::sqrt(5.0)/12.0, std::sqrt(5.0)/12.0, -1.0/12.0,
            (5.0-std::sqrt(5.0))/10.0, 1.0/12.0, 1.0/4.0, (10.0-7.0*std::sqrt(5.0))/60.0, std::sqrt(5.0)/60.0,
            (5.0+std::sqrt(5.0))/10.0, 1.0/12.0, (10.0+7.0*std::sqrt(5.0))/60.0, 1.0/4.0, -std::sqrt(5.0)/60.0,
            1, 1.0/12.0, 5.0/12.0, 5.0/12.0, 1.0/12.0,
            0, 1.0/12.0, 5.0/12.0, 5.0/12.0, 1.0/12.0
        }), "BT-Lobatto-6-4.bin"},

        {Matrix<float128_t>(7, 6, {
            1.0/4.0, 1.0/4.0, 0, 0, 0, 0,
            3.0/4.0, 1.0/2.0, 1.0/4.0, 0, 0, 0,
            11.0/20.0, 17.0/50.0, -1.0/25.0, 1.0/4.0, 0, 0,
            1.0/2.0, 371.0/1360.0, -137.0/2720.0, 15.0/544.0, 1.0/4.0, 0,
            1, 25.0/24.0, -49.0/48.0, 125.0/16.0, -85.0/12.0, 1.0/4.0,
            0, 25.0/24.0, -49.0/48.0, 125.0/16.0, -85.0/12.0, 1.0/4.0,
            0, 59.0/48.0, -17.0/96.0, 225.0/32.0, -85.0/12.0, 0

        }), "BT-LStableDiagonal-4-1.bin"},

        {Matrix<float128_t>(3, 3, {
            (3.0+std::sqrt(3.0))/6.0, (3.0+std::sqrt(3.0))/6.0, 0,
            (3.0-std::sqrt(3.0))/6.0, (-std::sqrt(3.0))/3.0, (3.0+std::sqrt(3.0))/6.0,
            0, 1.0/2.0, 1.0/2.0

        }), "BT-LStableDiagonal-3-1.bin"},

        {Matrix<float128_t>(9, 8, {
            0, 0, 0, 0, 0, 0, 0, 0,
            1.0/5.0, 1.0/5.0, 0, 0, 0, 0, 0, 0,
            3.0/10.0, 3.0/40.0, 9.0/40.0, 0, 0, 0, 0, 0,
            4.0/5.0, 44.0/45, -56.0/15.0, 32.0/9.0, 0, 0, 0, 0,
            8.0/9.0, 19372.0/6561.0, -25360.0/2187.0, 64448.0/6561.0, -212.0/729.0, 0, 0, 0,
            1, 9017.0/3168, -355.0/33.0, 46732.0/5247.0, 49.0/176.0, -5103.0/18656.0, 0, 0,
            1, 35.0/384.0, 0, 500.0/1113.0, 125.0/192.0, -2187.0/6784.0, 11.0/84.0, 0,
            0, 35.0/384.0, 0, 500.0/1113.0, 125.0/192.0, -2187.0/6784.0, 11.0/84.0, 0,
            0, 5179.0/57600.0, 0, 7571.0/16695.0, 393.0/640.0, -92097.0/339200.0, 187.0/2100.0, 1.0/40.0
        }), "BT-DormanPrince-4-1.bin"}

    };
    butcherWrite(tables);
    return 0;
}