#include <iostream>
#include <cmath>
#include "../Matrix.hpp"

// void butcherWrite () {
//     Matrix<double> matrix(4, 4, {
//         0, 0, 0, 0,
//         1.0/3.0, 1.0/3.0, 0, 0,
//         2.0/3.0, 0, 2.0/3.0, 0,
//         0, 1.0/4.0, 0, 3.0/4.0
//     });
//     std::string filename = "BT-RK-3-1.bin";

//     std::ofstream file(filename);
//     file << matrix;
//     file.close();
// }

// touch test{1..15}.txt

void butcherWrite (const std::vector<std::pair<Matrix<double>, std::string>> &tables) {
    for (uint64_t i = 0; i < tables.size(); ++i) {
        std::ofstream file(tables[i].second);
        file << tables[i].first;
        file.close();
    }
}

int main () {
    std::vector<std::pair<Matrix<double>, std::string>> tables = {

        {Matrix<double>(4, 4, {
            0, 0, 0, 0,
            1.0/3.0, 1.0/3.0, 0, 0,
            2.0/3.0, 0, 2.0/3.0, 0,
            0, 1.0/4.0, 0, 3.0/4.0
        }), "BT-RungeKutta-3-1.bin"},

        {Matrix<double>(4, 4, {
            0, 0, 0, 0,
            2.0/3.0, 2.0/3.0, 0, 0,
            2.0/3.0, -1.0/3.0, 1, 0,
            0, 1.0/4.0, 1.0/2.0, 1.0/4.0
        }), "BT-RungeKutta-3-2.bin"},

        {Matrix<double>(4, 4, {
            0, 0, 0, 0,
            1.0/2.0, 1.0/2.0, 0, 0,
            1, -1, 2, 0,
            0, 1.0/6.0, 2.0/3.0, 1.0/6.0
        }), "BT-RungeKutta-3-3.bin"},

        {Matrix<double>(4, 4, {
            0, 0, 0, 0,
            1.0/2.0, 1.0/2.0, 0, 0,
            3.0/4.0, 0, 3.0/4.0, 0,
            0, 2.0/9.0, 1.0/3.0, 4.0/9.0
        }), "BT-RungeKutta-3-4.bin"},

        {Matrix<double>(5, 5, {
            0, 0, 0, 0, 0,
            1.0/2.0, 1.0/2.0, 0, 0, 0,
            1.0/2.0, 0, 1.0/2.0, 0, 0,
            1, 0, 0, 1, 0,
            0, 1.0/6.0, 1.0/3.0, 1.0/3.0, 1.0/6.0
        }), "BT-RungeKutta-4-1.bin"},

        {Matrix<double>(5, 5, {
            0, 0, 0, 0, 0,
            1.0/3.0, 1.0/3.0, 0, 0, 0,
            2.0/3.0, -1.0/3.0, 1.0, 0, 0,
            1, 1, -1, 1, 0,
            0, 1.0/8.0, 3.0/8.0, 3.0/8.0, 1.0/8.0
        }), "BT-RungeKutta-4-2.bin"},

        {Matrix<double>(5, 5, {
            0, 0, 0, 0, 0,
            1.0/4.0, 1.0/4.0, 0, 0, 0,
            1.0/2.0, 0, 1.0/2.0, 0, 0,
            1, 1, -2, 2, 0,
            0, 1.0/6.0, 0, 2.0/3.0, 1.0/6.0
        }), "BT-RungeKutta-4-3.bin"},

        {Matrix<double>(5, 5, {
            0, 0, 0, 0, 0,
            1.0/2.0, 1.0/2.0, 0, 0, 0,
            1.0/2.0, (std::sqrt(2.0)-1.0)/2.0, 1.0-1.0/std::sqrt(2.0), 0, 0,
            1, 0, -1.0/std::sqrt(2.0), 1.0+1.0/std::sqrt(2.0), 0,
            0, 1.0/6.0, 1.0/3.0-1.0/(3*std::sqrt(2.0)), 1.0/3.0+1.0/(3*std::sqrt(2.0)), 1.0/6.0
        }), "BT-RungeKutta-4-4.bin"},

        {Matrix<double>(5, 4, {
            0, 0, 0, 0,
            1, 1, 0, 0,
            1.0/2.0, 1.0/4.0, 1.0/4.0, 0,
            0, 1.0/2.0, 1.0/2.0, 0,
            0, 1.0/6.0, 1.0/6.0, 4.0/6.0
        }), "BT-Falberg-2-1.bin"},

        {Matrix<double>(6, 5, {
            0, 0, 0, 0, 0,
            1.0/4.0, 1.0/4.0, 0, 0, 0,
            27.0/40.0, -189.0/800.0, 729.0/800.0, 0, 0,
            1, 214.0/891.0, 1.0/33.0, 650.0/891.0, 0,
            0, 214.0/891.0, 1.0/33.0, 650.0/891.0, 0,
            0, 533.0/2106.0, 0, 800.0/1053.0, -1.0/78.0
        }), "BT-Falberg-2-2.bin"},

        {Matrix<double>(6, 5, {
            0, 0, 0, 0, 0,
            1.0/4.0, 1.0/4.0, 0, 0, 0,
            1.0/2.0, 0, 1.0/2.0, 0, 0,
            1, 1, -2, 2, 0,
            0, 1, -2, 0, 2,
            0, 1.0/6.0, 0, 4.0/6.0, 1.0/6.0
        }), "BT-Cheskino-2-1.bin"},

        {Matrix<double>(7, 6, {
            0, 0, 0, 0, 0, 0,
            1.0/3.0, 1.0/3.0, 0, 0, 0, 0,
            1.0/3.0, 1.0/6.0, 1.0/6.0, 0, 0, 0,
            1.0/2.0, 1.0/8.0, 0, 3.0/8.0, 0, 0,
            1, 1.0/2.0, 0, -3.0/2.0, 2, 0,
            0, 1.0/10.0, 0, 3.0/10.0, 2.0/5.0, 1.0/5.0,
            0, 1.0/6.0, 0, 0, 2.0/3.0, 1.0/6.0
        }), "BT-Merson-3-1.bin"},

        {Matrix<double>(2, 2, {
            1, 1,
            0, 1
        }), "BT-Rado-1-1.bin"},

        {Matrix<double>(3, 3, {
            1.0/3.0, 5.0/12.0, -1.0/12.0,
            1, 3.0/4.0, 1.0/4.0,
            0, 3.0/4.0, 1.0/4.0
        }), "BT-Rado-3-1.bin"},

        {Matrix<double>(4, 4, {
            (4.0-std::sqrt(6.0))/10, (88.0-7*std::sqrt(6.0))/360, (296.0-169*std::sqrt(6.0))/1800, (-2.0+3*std::sqrt(6.0))/255,
            (4.0+std::sqrt(6.0))/10, (296.0+169*std::sqrt(6.0))/1800, (88.0+7*std::sqrt(6.0))/360, (-2.0-3*std::sqrt(6.0))/255,
            1, (16.0-std::sqrt(6.0))/36, (16.0+std::sqrt(6.0))/36, 1.0/9.0,
            0, (16.0-std::sqrt(6.0))/36, (16.0+std::sqrt(6.0))/36, 1.0/9.0
        }), "BT-Rado-5-1.bin"},

        {Matrix<double>(2, 2, {
            1.0/2.0, 1.0/2.0,
            0, 1
        }), "BT-Gauss-2-1.bin"},

        {Matrix<double>(3, 3, {
            1.0/2.0-std::sqrt(3.0)/6.0, 1.0/4.0, 1.0/4.0-std::sqrt(3.0)/6.0,
            1.0/2.0+std::sqrt(3.0)/6.0, 1.0/4.0+std::sqrt(3.0)/6.0, 1.0/4.0,
            0, 1.0/2.0, 1.0/2.0
        }), "BT-Gauss-4-1.bin"},

        {Matrix<double>(4, 4, {
            1.0/2.0-std::sqrt(15.0)/10.0, 5.0/36.0, 2.0/9.0-std::sqrt(15.0)/15.0, 5.0/36.0-std::sqrt(15.0)/30.0,
            1.0/2.0, 5.0/36.0+std::sqrt(15.0)/24.0, 2.0/9.0, 5.0/36.0-std::sqrt(15.0)/24.0,
            1.0/2.0+std::sqrt(15.0)/10.0, 5.0/36.0+std::sqrt(15.0)/30.0, 2.0/9.0+std::sqrt(15.0)/15.0, 5.0/36.0,
            0, 5.0/18.0, 4.0/9.0, 5.0/18.0
        }), "BT-Gauss-6-1.bin"},

        {Matrix<double>(3, 3, {
            0, 0, 0,
            1, 1.0/2.0, 1.0/2.0,
            0, 1.0/2.0, 1.0/2.0
        }), "BT-Lobatto-2-1.bin"},

        {Matrix<double>(3, 3, {
            0, 1.0/2.0, 0,
            1, 1.0/2.0, 0,
            0, 1.0/2.0, 1.0/2.0
        }), "BT-Lobatto-2-2.bin"},

        {Matrix<double>(3, 3, {
            0, 1.0/2.0, -1.0/2.0,
            1, 1.0/2.0, 1.0/2.0,
            0, 1.0/2.0, 1.0/2.0
        }), "BT-Lobatto-2-3.bin"},

        {Matrix<double>(3, 3, {
            0, 0, 0,
            2.0/3.0, 1.0/3.0, 1.0/3.0,
            0, 1.0/4.0, 3.0/4.0
        }), "BT-Lobatto-2-4.bin"},

        {Matrix<double>(4, 4, {
            0, 0, 0, 0,
            1.0/2.0, 1.0/4.0, 1.0/4.0, 0,
            1, 0, 1, 0,
            0, 1.0/6.0, 2.0/3.0, 1.0/6.0
        }), "BT-Lobatto-4-1.bin"},

        {Matrix<double>(4, 4, {
            0, 0, 0, 0,
            1.0/2.0, 5.0/24.0, 1.0/3.0, -1.0/24.0,
            1, 1.0/6.0, 2.0/3.0, 1.0/6.0,
            0, 1.0/6.0, 2.0/3.0, 1.0/6.0
        }), "BT-Lobatto-4-2.bin"},

        {Matrix<double>(4, 4, {
            0, 1.0/6.0, -1.0/6.0, 0,
            1.0/2.0, 1.0/6.0, 1.0/3.0, 0,
            1, 1.0/6.0, 5.0/6.0, 0,
            0, 1.0/6.0, 2.0/3.0, 1.0/6.0
        }), "BT-Lobatto-4-3.bin"},

        {Matrix<double>(4, 4, {
            0, 1.0/6.0, -1.0/3.0, 1.0/6.0,
            1.0/2.0, 1.0/6.0, 5.0/12.0, -1.0/12.0,
            1, 1.0/6.0, 2.0/3.0, 1.0/6.0,
            0, 1.0/6.0, 2.0/3.0, 1.0/6.0
        }), "BT-Lobatto-4-4.bin"}

    };
    butcherWrite(tables);
    return 0;
}